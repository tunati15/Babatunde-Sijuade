#!/usr/bin/env groovy
pipeline {
    agent any
    environment {
        AWS_DEFAULT_REGION = "us-east-1"
    }
     stages {
         stage("Build Image") {
            steps {
                sh 'docker login -u AWS -p $(aws ecr get-login-password --region us-east-1) 893971510987.dkr.ecr.us-east-1.amazonaws.com'
                sh 'docker build -t planning-poker .'
                sh 'docker tag  planning-poker:latest 893971510987.dkr.ecr.us-east-1.amazonaws.com/planning-poker:""$BUILD_ID""'
                sh 'docker push 893971510987.dkr.ecr.us-east-1.amazonaws.com/planning-poker:""$BUILD_ID""'
                    }
                }
           } 
         }
     
